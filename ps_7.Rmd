---
title: "ps_7"
author: "Connor Riordan"
date: "4/7/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(stringr)
library(readr)
library(janitor)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(stringr)
library(skimr)
library(purrr)
library(tibble)
library(stringr)
library(forcats)
```

## 1A

```{r, chunk_1A, echo = FALSE}
government <- read.csv("data_directory/HSall_members.csv") %>%
  clean_names()

g <- government %>%
  filter(congress == 116) %>%
  filter(chamber == "Senate" | chamber == "House") %>%
  mutate(party = ifelse(party_code == 200, "Republican",
                        ifelse(party_code == 100, "Democrat", 
                               ifelse(party_code == 328, "Independent", "N/A")))) %>%
  filter(!party == "Independent") %>%
  mutate(age = 2019-born) %>%
  mutate(nominate_percentile = percent_rank(nominate_dim1))

g %>%
  skim(nominate_percentile, age) %>%
  print()

```

## 1B

```{r, chunk_1B, echo = FALSE, message = FALSE}
g %>%
  ggplot(aes(age)) + geom_histogram(bins = 30, color = "purple", fill = "dark grey") +
  theme_bw() + labs(
    title = "Distribution of Congressional Ages",
    x = "Age",
    y = "Count"
  ) %>%
  print()

g %>%
  ggplot(aes(nominate_percentile)) + geom_histogram(bins = 30, color = "blue", fill = "dark grey") +
  theme_bw() + labs(
    title = "Distribution of Nomination Percentiles",
    x = "Nomination Percentile",
    y = "Count"
  ) %>%
  print()

```

## 1C

```{r, chunk_1C, echo = FALSE}
g %>%
  summarize(correlation = cor(age, nominate_percentile)) %>%
  print()

# A negative coefficient would indicate that as age increases, the 




```














